Hvilken alders gruppe kan godt lide dårlige film. (avg. movie rating)


Pre agg. if movie.rating < 3 = badmovies;

for(badmovies)
	for(users)
		if(user.movie.rating >=4)
			user likes bad movie = count
if count > 10
	user really likes bad movies;

select avg(rating) from rating group by movieid;

 select movieid ,avg(rating), count(rating) from rating group by movieid having count(rating) > 40 order by avg(rating) limit 100;

CREATE TABLE avgMovie(id INT, avgrating double, PRIMARY KEY (id));
INSERT INTO avgMovie (id,avgrating) select movieid ,avg(rating) from rating group by movieid having count(rating) > 40

Create table badMovies(id int, avgRating double, primary key (id));
insert into badMovies(id,avgRating) select * from avgMovie where avgRating < 3;

create table badUsers(id int, primary key (id));
insert into badUsers(id) select userId from rating, badmovies where movieId = id and rating >= 4 group by userId having count(userId) >= 10;


select age,count(user.id) from badusers, user where user.id = badusers.id group by age;
